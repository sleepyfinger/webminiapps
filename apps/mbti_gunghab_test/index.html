<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MBTI Í∂ÅÌï© Í≥ÑÏÇ∞Í∏∞</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap");

      body {
        background: linear-gradient(135deg, #d2b4de 0%, #a9cce3 100%);
        min-height: 100vh;
        font-family: "Noto Sans KR", sans-serif;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .container {
        flex-grow: 1;
        padding-top: 20px;
        padding-bottom: 20px;
      }
      .card {
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        border-radius: 1.5rem;
        border: none;
        background-color: #ffffff;
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInCard 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.1s
          forwards;
      }
      h2 {
        color: #9b59b6;
        font-weight: 700;
      }
      .card-icon {
        font-size: 2.5rem;
        color: #9b59b6;
        margin-bottom: 0.5rem;
        text-align: center;
      }
      .form-label {
        font-weight: 500;
        color: #555;
      }
      .form-control {
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
        border-color: #ddd;
      }
      .form-control:focus {
        border-color: #b088f0;
        box-shadow: 0 0 0 0.25rem rgba(155, 89, 182, 0.25);
      }
      .btn-primary {
        background-color: #9b59b6;
        border-color: #9b59b6;
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
        font-size: 1.1rem;
        font-weight: 600;
        transition: background-color 0.3s ease;
      }
      .btn-primary:hover {
        background-color: #8e44ad;
        border-color: #8e44ad;
      }
      #result {
        margin-top: 2rem;
        padding: 1.5rem;
        background-color: #fff;
        border-radius: 1rem;
        border: 1px solid #e5e7eb;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.07);
        text-align: left;
        opacity: 0;
        transform: scale(0.95) translateY(10px);
        transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
          transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
          visibility 0s linear 0.4s; /* Smoother timing for result appearance */
        visibility: hidden;
      }
      .compat-score-value {
        font-size: 3rem;
        font-weight: bold;
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
        transition: color 0.5s;
        text-align: center;
      }
      .compat-anim {
        animation: pop 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      }
      @keyframes pop {
        0% {
          transform: scale(0.7);
          opacity: 0.5;
        }
        60% {
          transform: scale(1.15);
          opacity: 1;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      @keyframes fadeInCard {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      #result.visible {
        opacity: 1;
        transform: scale(1) translateY(0);
        visibility: visible;
        transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
          transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
          visibility 0s linear 0s;
      }
      .btn-outline-secondary.share-btn {
        color: #9b59b6;
        border-color: #9b59b6;
        transition: all 0.3s ease;
      }
      .btn-outline-secondary.share-btn:hover {
        color: #fff;
        background-color: #9b59b6;
        border-color: #9b59b6;
      }
      .share-btn {
        margin-top: 1.8rem;
        width: 100%;
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
        font-size: 1.1rem;
        font-weight: 600;
      }
      .mbti-badge {
        font-size: 1.1rem;
        background: #f2eaf7;
        color: #8e44ad;
        border-radius: 0.75em;
        padding: 0.3em 0.8em;
        margin: 0 0.5em;
        display: inline-block;
        font-weight: 600;
      }
      .result-connector {
        font-size: 1.8rem;
        color: #e74c3c;
        margin: 0 0.75rem;
      }
      .score-bar-container {
        background-color: #e9ecef;
        border-radius: 0.5rem;
        height: 12px;
        overflow: hidden;
      }
      .score-bar {
        height: 100%;
        border-radius: 0.5rem;
        transition: width 0.8s cubic-bezier(0.25, 0.1, 0.25, 1),
          background-color 0.5s ease-in-out;
      }
      .result-section-title {
        font-weight: 600;
        color: #8e44ad;
        margin-top: 1rem;
        margin-bottom: 0.5rem;
      }
      .result-tip {
        background-color: #f3e8ff;
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        color: #6c3483;
        font-size: 0.95rem;
      }
      .result-description {
        font-size: 1.05rem;
        color: #4b5563;
      }
      .footer {
        text-align: center;
        padding: 1.5rem 0;
        margin-top: 3rem;
        color: #495057;
        font-size: 0.875rem;
        width: 100%;
        border-top: 1px solid rgba(0, 0, 0, 0.1);
      }
      .footer a {
        color: #6c757d;
        font-weight: 500;
        text-decoration: none;
        transition: color 0.2s ease, text-decoration 0.2s ease;
      }
      .footer a:hover {
        color: #343a40;
        text-decoration: underline;
      }

      @media (max-width: 576px) {
        .card {
          padding: 1.5rem !important;
        }
        .compat-score-value {
          font-size: 2.5rem;
        }
        .mbti-badge {
          font-size: 1rem;
          margin: 0 0.3em;
        }
      }
    </style>
  </head>
  <body>
    <div
      class="container d-flex flex-column justify-content-center align-items-center"
    >
      <div class="card p-4" style="max-width: 420px; width: 100%">
        <div class="card-icon">
          <i class="bi bi-chat-heart-fill"></i>
        </div>
        <h2 class="text-center mb-4">MBTI Í∂ÅÌï© Í≥ÑÏÇ∞Í∏∞</h2>
        <form id="compatForm" autocomplete="off">
          <div class="mb-3">
            <label for="mbti1" class="form-label">Ï≤´ Î≤àÏß∏ MBTI</label>
            <input
              list="mbti-types"
              class="form-control"
              id="mbti1"
              maxlength="4"
              required
              placeholder="Ïòà: INFP"
              autocomplete="off"
            />
          </div>
          <div class="mb-3">
            <label for="mbti2" class="form-label">Îëê Î≤àÏß∏ MBTI</label>
            <input
              list="mbti-types"
              class="form-control"
              id="mbti2"
              maxlength="4"
              required
              placeholder="Ïòà: ENFJ"
              autocomplete="off"
            />
          </div>
          <datalist id="mbti-types">
            <option value="ISTJ"></option>
            <option value="ISFJ"></option>
            <option value="INFJ"></option>
            <option value="INTJ"></option>
            <option value="ISTP"></option>
            <option value="ISFP"></option>
            <option value="INFP"></option>
            <option value="INTP"></option>
            <option value="ESTP"></option>
            <option value="ESFP"></option>
            <option value="ENFP"></option>
            <option value="ENTP"></option>
            <option value="ESTJ"></option>
            <option value="ESFJ"></option>
            <option value="ENFJ"></option>
            <option value="ENTJ"></option>
          </datalist>

          <button type="submit" class="btn btn-primary w-100">Í∂ÅÌï© Í≥ÑÏÇ∞</button>
        </form>
        <div id="result"></div>
        <button
          id="shareBtn"
          class="btn btn-outline-secondary share-btn d-none"
        >
          Í≤∞Í≥º Í≥µÏú†
        </button>
      </div>
    </div>
    <footer class="footer">
      <p class="mb-0">
        &copy; 2025
        <a href="https://blog.naver.com/sleepyfinger" target="_blank"
          >SleepyFinger</a
        >. All Rights Reserved.
      </p>
    </footer>
    <script>
      const mbtiCompatibilityTable = {
        INFP: {
          ENFJ: 100,
          ENTJ: 100,
          INFJ: 80,
          ENFP: 80,
          INTJ: 80,
          INFP: 80,
          ISFJ: 60,
          ESFJ: 60,
          ISTJ: 60,
          INTP: 60,
          ISFP: 60,
          ENTP: 60,
          ESTJ: 40,
          ESFP: 40,
          ISTP: 40,
          ESTP: 20,
        },
        ENFJ: {
          INFP: 100,
          ISFP: 100,
          INFJ: 80,
          ENFP: 80,
          ENFJ: 80,
          ESFJ: 80,
          INTJ: 80,
          ENTJ: 80,
          ISFJ: 60,
          ESFP: 60,
          ENTP: 60,
          ESTJ: 60,
          ISTJ: 40,
          ISTP: 40,
          INTP: 40,
          ESTP: 20,
        },
        ENTJ: {
          INFP: 100,
          ISFP: 100,
          ENTP: 80,
          INTP: 80,
          ENTJ: 80,
          INTJ: 80,
          ENFJ: 80,
          ENFP: 80,
          ISTJ: 60,
          ESTJ: 60,
          ISFJ: 60,
          ESFJ: 60,
          ISTP: 40,
          ESTP: 40,
          ESFP: 20,
        },
        INFJ: {
          ENFP: 100,
          ENTP: 100,
          INFP: 80,
          ENFJ: 80,
          INFJ: 80,
          INTJ: 80,
          INTP: 80,
          ISFJ: 60,
          ESFJ: 60,
          ISTJ: 60,
          ENTJ: 60,
          ISFP: 40,
          ESTJ: 40,
          ESFP: 40,
          ISTP: 20,
          ESTP: 20,
        },
        ENFP: {
          INFJ: 100,
          INTJ: 100,
          INFP: 80,
          ENFJ: 80,
          ENFP: 80,
          ENTP: 80,
          ISFP: 80,
          ESFP: 80,
          ENTJ: 60,
          INTP: 60,
          ESFJ: 60,
          ESTJ: 60,
          ISTJ: 40,
          ISFJ: 40,
          ISTP: 40,
          ESTP: 20,
        },
        INTJ: {
          ENFP: 100,
          ENTP: 100,
          INFP: 80,
          ENFJ: 80,
          INFJ: 80,
          INTJ: 80,
          ENTJ: 80,
          INTP: 80,
          ISTJ: 60,
          ESTJ: 60,
          ISFJ: 60,
          ESFJ: 60,
          ISFP: 40,
          ESFP: 40,
          ISTP: 40,
          ESTP: 20,
        },
        ISTJ: {
          ESFP: 100,
          ESTP: 100,
          ISFJ: 80,
          ISTJ: 80,
          ESTJ: 80,
          ESFJ: 80,
          INTJ: 60,
          ENTJ: 60,
          ISFP: 60,
          INFP: 60,
          ENFP: 60,
          INFJ: 60,
          ISTP: 40,
          ESTP: 40,
          ENTP: 40,
          ENFJ: 20,
        },
        ISFJ: {
          ESTP: 100,
          ESFP: 100,
          ISTJ: 80,
          ISFJ: 80,
          ESTJ: 80,
          ESFJ: 80,
          ENFJ: 80,
          INFP: 60,
          ENFP: 60,
          INTJ: 60,
          ENTJ: 60,
          ISFP: 60,
          ISTP: 40,
          ESTP: 40,
          ENTP: 40,
          INFJ: 20,
        },
        ISTP: {
          ESFJ: 100,
          ENFJ: 100,
          ISTP: 80,
          ESTP: 80,
          ISFP: 80,
          ESTJ: 80,
          ISTJ: 80,
          ENTP: 60,
          INTP: 60,
          ISFJ: 60,
          INFP: 60,
          ENFP: 60,
          INTJ: 40,
          ENTJ: 40,
          ESFP: 40,
          INFJ: 20,
        },
        ISFP: {
          ENFJ: 100,
          ESFJ: 100,
          ISFP: 80,
          ESFP: 80,
          ISTP: 80,
          ESTP: 80,
          INFP: 80,
          ENFP: 80,
          ISTJ: 60,
          ISFJ: 60,
          INTJ: 60,
          ENTJ: 60,
          INTP: 40,
          ENTP: 40,
          ESTJ: 40,
          INFJ: 20,
        },
        ESTP: {
          ISFJ: 100,
          ISTJ: 100,
          ESFP: 80,
          ESTP: 80,
          ISTP: 80,
          ISFP: 80,
          ESTJ: 80,
          ESFJ: 80,
          ENFJ: 60,
          INFP: 60,
          ENFP: 60,
          INTP: 60,
          INTJ: 40,
          ENTJ: 40,
          INFJ: 40,
          ENTP: 20,
        },
        ESFP: {
          ISTJ: 100,
          ISFJ: 100,
          ESFP: 80,
          ISFP: 80,
          ESTP: 80,
          ISTP: 80,
          ESFJ: 80,
          ESTJ: 80,
          ENFP: 60,
          INFP: 60,
          ENFJ: 60,
          INTP: 60,
          INTJ: 40,
          ENTJ: 40,
          INFJ: 40,
          ENTP: 20,
        },
        ESTJ: {
          ISFP: 100,
          ISTP: 100,
          ESTJ: 80,
          ISTJ: 80,
          ESTP: 80,
          ISTP: 80,
          ESFJ: 80,
          ISFJ: 80,
          ENTJ: 60,
          INTJ: 60,
          ENFJ: 60,
          INFJ: 60,
          INFP: 40,
          ENFP: 40,
          INTP: 40,
          ENTP: 20,
        },
        ESFJ: {
          ISTP: 100,
          ISFP: 100,
          ESFJ: 80,
          ISFJ: 80,
          ESTJ: 80,
          ISTJ: 80,
          ESFP: 80,
          ESTP: 80,
          ENFJ: 80,
          INFP: 60,
          ENFP: 60,
          INTJ: 60,
          ENTJ: 60,
          INTP: 40,
          ENTP: 40,
          INFJ: 20,
        },
        INTP: {
          ENTJ: 100,
          ENFJ: 100,
          INTP: 80,
          ENTP: 80,
          INTJ: 80,
          INFP: 80,
          ENFP: 80,
          INFJ: 80,
          ISFP: 60,
          ISTP: 60,
          ESFP: 60,
          ESTP: 60,
          ISTJ: 40,
          ISFJ: 40,
          ESTJ: 40,
          ESFJ: 20,
        },
        ENTP: {
          INFJ: 100,
          INTJ: 100,
          ENTP: 80,
          INTP: 80,
          ENFP: 80,
          ENFJ: 80,
          ENTJ: 80,
          INFP: 80,
          ISFP: 60,
          ISTP: 60,
          ESFP: 60,
          ESTP: 60,
          ISTJ: 40,
          ISFJ: 40,
          ESTJ: 40,
          ESFJ: 20,
        },
      };

      const compatibilityDescriptions = [
        {
          min: 90,
          max: 100,
          text: "‚ú® Ï≤úÏÉùÏó∞Î∂Ñ! ÏÑúÎ°úÏóêÍ≤å ÏôÑÎ≤ΩÌïú ÌååÌä∏ÎÑàÏòàÏöî. Ìï®Íªò ÏûàÏúºÎ©¥ ÏõÉÏùåÏù¥ ÎÅäÏù¥ÏßÄ ÏïäÍ≥†, ÏÑúÎ°úÏùò Ï°¥Ïû¨ÎßåÏúºÎ°úÎèÑ ÌÅ∞ ÌûòÏù¥ Îê©ÎãàÎã§. ÎßàÏπò ÏòÅÌôî ÏÜç Ìïú Ïû•Î©¥Ï≤òÎüº Î°úÎß®Ìã±ÌïòÍ≥† Ïù¥ÏÉÅÏ†ÅÏù∏ Í¥ÄÍ≥ÑÏûÖÎãàÎã§.",
          tip: "ÏßÄÍ∏àÏ≤òÎüº ÏÑúÎ°úÎ•º ÏïÑÎÅºÍ≥† Ï°¥Ï§ëÌïòÎ©∞ ÏÇ¨ÎûëÏùÑ ÌÇ§ÏõåÎÇòÍ∞ÄÏÑ∏Ïöî. Ìï®ÍªòÌïòÎäî Î™®Îì† ÏàúÍ∞ÑÏù¥ ÏÜåÏ§ëÌïú Ï∂îÏñµÏù¥ Îê† Í±∞ÏòàÏöî. Í∞ÄÎÅîÏùÄ ÌäπÎ≥ÑÌïú Îç∞Ïù¥Ìä∏Î°ú ÏÑúÎ°úÏóêÍ≤å Í∞êÎèôÏùÑ ÏÑ†Î¨ºÌï¥Î≥¥ÏÑ∏Ïöî! üéâ",
        },
        {
          min: 70,
          max: 89,
          text: "üíñ ÏïÑÏ£º Ï¢ãÏùÄ Í∂ÅÌï©! ÏÑúÎ°úÏóêÍ≤å Í∏çÏ†ïÏ†ÅÏù∏ ÏòÅÌñ•ÏùÑ Ï£ºÎ©∞ Ìï®Íªò ÏÑ±Ïû•ÌïòÎäî ÏïÑÎ¶ÑÎã§Ïö¥ Í¥ÄÍ≥ÑÏûÖÎãàÎã§. ÏÑúÎ°úÏùò Îã§Î¶ÑÏùÑ Ïù¥Ìï¥ÌïòÍ≥† Ï°¥Ï§ëÌïòÎ©∞, ÏïàÏ†ïÍ∞êÍ≥º ÌñâÎ≥µÏùÑ ÎäêÎÇÑ Ïàò ÏûàÏäµÎãàÎã§.",
          tip: "ÏÑúÎ°úÏùò Í¥ÄÏã¨ÏÇ¨Î•º Í≥µÏú†ÌïòÍ≥† Ìï®Íªò ÏÉàÎ°úÏö¥ Í≤ÉÏùÑ Í≤ΩÌóòÌï¥Î≥¥ÏÑ∏Ïöî. ÏûëÏùÄ Ïπ≠Ï∞¨Í≥º Í≤©Î†§Îäî Í¥ÄÍ≥ÑÎ•º ÎçîÏö± Îã®Îã®ÌïòÍ≤å ÎßåÎì§Ïñ¥ Ï§Ñ Í±∞ÏòàÏöî. ÏÑúÎ°úÏóêÍ≤å Îì†Îì†Ìïú ÏßÄÏõêÍµ∞Ïù¥ ÎêòÏñ¥Ï£ºÏÑ∏Ïöî. üòä",
        },
        {
          min: 50,
          max: 69,
          text: "üôÇ Í¥úÏ∞ÆÏùÄ Í∂ÅÌï©! ÏÑúÎ°ú Ïûò ÎßûÎäî Î∂ÄÎ∂ÑÎèÑ ÏûàÏßÄÎßå, Í∞ÄÎÅîÏùÄ Îã§Î•∏ ÏÉùÍ∞ÅÍ≥º Î∞©ÏãùÏúºÎ°ú Ïù∏Ìï¥ ÏûëÏùÄ Îã§ÌàºÏù¥ ÏÉùÍ∏∏ ÏàòÎèÑ ÏûàÏñ¥Ïöî. ÌïòÏßÄÎßå ÏÑúÎ°ú ÎÖ∏Î†•ÌïòÎ©¥ Ï∂©Î∂ÑÌûà Ï¢ãÏùÄ Í¥ÄÍ≥ÑÎ•º ÎßåÎì§ Ïàò ÏûàÏäµÎãàÎã§.",
          tip: "ÏÑúÎ°úÏùò ÏÉùÍ∞ÅÍ≥º Í∞êÏ†ïÏùÑ ÏÜîÏßÅÌïòÍ≤å ÌëúÌòÑÌïòÍ≥†, ÏÉÅÎåÄÎ∞©Ïùò Ïù¥ÏïºÍ∏∞Î•º Í≤ΩÏ≤≠ÌïòÎäî ÏûêÏÑ∏Í∞Ä Ï§ëÏöîÌï¥Ïöî. Ìï®Íªò Ï∑®ÎØ∏Î•º ÎßåÎì§Í±∞ÎÇò, Í≥µÌÜµÏùò Î™©ÌëúÎ•º ÏÑ∏ÏõåÎ≥¥Îäî Í≤ÉÎèÑ Ï¢ãÏùÄ Î∞©Î≤ïÏûÖÎãàÎã§. üí¨",
        },
        {
          min: 30,
          max: 49,
          text: "ü§î Ï°∞Í∏àÏùÄ Îã§Î•∏ Ïä§ÌÉÄÏùº! ÏÑúÎ°ú Îã§Î•∏ Ï†êÏù¥ ÎßéÏïÑ Ïù¥Ìï¥ÌïòÎäî Îç∞ ÏãúÍ∞ÑÏù¥ ÌïÑÏöîÌï† Ïàò ÏûàÏñ¥Ïöî. ÌïòÏßÄÎßå ÏÑúÎ°úÏùò Ï∞®Ïù¥Î•º Ïù∏Ï†ïÌïòÍ≥† Ï°¥Ï§ëÌïúÎã§Î©¥, Ïò§ÌûàÎ†§ ÏÉàÎ°úÏö¥ Í≤ÉÏùÑ Î∞∞Ïö∞Í≥† ÏÑ±Ïû•ÌïòÎäî Í≥ÑÍ∏∞Í∞Ä Îê† Ïàò ÏûàÏäµÎãàÎã§.",
          tip: "ÏÑúÎ°úÏùò Îã§Î¶ÑÏùÑ 'ÌãÄÎ¶º'Ïù¥ ÏïÑÎãå 'Îã§Î¶Ñ'ÏúºÎ°ú Î∞õÏïÑÎì§Ïù¥Îäî Ïó∞ÏäµÏù¥ ÌïÑÏöîÌï¥Ïöî. ÏÉÅÎåÄÎ∞©Ïùò Ïû•Ï†êÏùÑ Î∞úÍ≤¨ÌïòÍ≥† Ïπ≠Ï∞¨Ìï¥Ï£ºÏÑ∏Ïöî. ÏûëÏùÄ ÎÖ∏Î†•Îì§Ïù¥ Î™®Ïó¨ Í¥ÄÍ≥ÑÎ•º Í∏çÏ†ïÏ†ÅÏúºÎ°ú Î≥ÄÌôîÏãúÌÇ¨ Ïàò ÏûàÏäµÎãàÎã§. üíñ",
        },
        {
          min: 0,
          max: 29,
          text: "üò• ÏÉÅÎ∞òÎêú ÏÑ±Ìñ•! ÎßàÏπò ÏûêÏÑùÏùò Í∞ôÏùÄ Í∑πÏ≤òÎüº ÏÑúÎ°ú Î∞ÄÏñ¥ÎÇ¥Îäî ÎäêÎÇåÏùÑ Î∞õÏùÑ Ïàò ÏûàÏñ¥Ïöî. ÎßéÏùÄ ÎÖ∏Î†•Í≥º Ïù¥Ìï¥Í∞Ä ÌïÑÏöîÌïú Í¥ÄÍ≥ÑÏù¥ÏßÄÎßå, Î∂àÍ∞ÄÎä•Ìïú Í≤ÉÏùÄ ÏïÑÎãôÎãàÎã§.",
          tip: "ÏÑúÎ°úÏùò Í∞úÏù∏Ï†ÅÏù∏ Í≥µÍ∞ÑÍ≥º ÏãúÍ∞ÑÏùÑ Ï°¥Ï§ëÌï¥Ï£ºÏÑ∏Ïöî. Í∞àÎì±Ïù¥ ÏÉùÍ≤ºÏùÑ ÎïåÎäî Í∞êÏ†ïÏ†ÅÏúºÎ°ú ÎåÄÏùëÌïòÍ∏∞Î≥¥Îã§, Ï∞®Î∂ÑÌïòÍ≤å ÎåÄÌôîÎ°ú ÌíÄÏñ¥ÎÇòÍ∞ÄÎäî Í≤ÉÏù¥ Ï§ëÏöîÌï¥Ïöî. ÏÑúÎ°úÏùò 'Îã§Î¶Ñ' ÏÜçÏóêÏÑú Î∞∞Ïö∏ Ï†êÏùÑ Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî. üôè",
        },
      ];

      function getScoreColor(score) {
        if (score >= 90) return "#a78bfa";
        if (score >= 70) return "#fb7185";
        if (score >= 50) return "#2ecc71";
        if (score >= 30) return "#f39c12";
        return "#e74c3c";
      }

      function isValidMBTI(str) {
        const validTypes = [
          "ISTJ",
          "ISFJ",
          "INFJ",
          "INTJ",
          "ISTP",
          "ISFP",
          "INFP",
          "INTP",
          "ESTP",
          "ESFP",
          "ENFP",
          "ENTP",
          "ESTJ",
          "ESFJ",
          "ENFJ",
          "ENTJ",
        ];
        return validTypes.includes(str.toUpperCase());
      }

      function getCompatibilityScore(mbti1, mbti2) {
        mbti1 = mbti1.toUpperCase();
        mbti2 = mbti2.toUpperCase();
        if (
          mbtiCompatibilityTable[mbti1] &&
          mbtiCompatibilityTable[mbti1][mbti2] !== undefined
        ) {
          return mbtiCompatibilityTable[mbti1][mbti2];
        }
        let score = 0;
        for (let i = 0; i < 4; i++) {
          if (mbti1[i] === mbti2[i]) score += 25;
        }
        return score;
      }

      function shareResult(mbti1, mbti2, score, desc) {
        const emoji =
          score >= 90
            ? "üíñ"
            : score >= 70
            ? "üòä"
            : score >= 50
            ? "üôÇ"
            : score >= 30
            ? "ü§î"
            : "üò•";
        const shareText = `${emoji} MBTI Í∂ÅÌï© Í≤∞Í≥º!\n${mbti1} ‚ù§Ô∏è ${mbti2} = ${score}%\n"${desc}"\n\nÎÇòÏùò MBTI Í∂ÅÌï©ÎèÑ Ïó¨Í∏∞ÏÑú ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî:\n${window.location.href}`;
        const customUrl =
          "https://sleepyfinger.github.io/webminiapps/showcase/mbti_gunghab_test";
        if (navigator.share) {
          navigator.share({
            title: "MBTI Í∂ÅÌï© Í≤∞Í≥º",
            text: `${emoji} MBTI Í∂ÅÌï© Í≤∞Í≥º!\n${mbti1} ‚ù§Ô∏è ${mbti2} = ${score}%\n"${desc}"\n\nÎÇòÏùò MBTI Í∂ÅÌï©ÎèÑ Ïó¨Í∏∞ÏÑú ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî:\n${customUrl}`,
            url: customUrl,
          });
        } else {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard
              .writeText(
                `${emoji} MBTI Í∂ÅÌï© Í≤∞Í≥º!\n${mbti1} ‚ù§Ô∏è ${mbti2} = ${score}%\n"${desc}"\n\nÎÇòÏùò MBTI Í∂ÅÌï©ÎèÑ Ïó¨Í∏∞ÏÑú ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî:\n${customUrl}`
              )
              .then(() => {
                alert("Í≤∞Í≥ºÍ∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!");
              })
              .catch((err) => {
                console.error("ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨ Ïã§Ìå®:", err);
                alert("ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
              });
          } else {
            const resultDiv = document.getElementById("result");
            const shareableText = document.createElement("textarea");
            shareableText.value = `${emoji} MBTI Í∂ÅÌï© Í≤∞Í≥º!\n${mbti1} ‚ù§Ô∏è ${mbti2} = ${score}%\n"${desc}"\n\nÎÇòÏùò MBTI Í∂ÅÌï©ÎèÑ Ïó¨Í∏∞ÏÑú ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî:\n${customUrl}`;
            shareableText.readOnly = true;
            shareableText.style.width = "100%";
            shareableText.style.minHeight = "100px";
            resultDiv.appendChild(shareableText);
            alert(
              "Í≥µÏú† Í∏∞Îä•ÏùÑ ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÎäî ÌôòÍ≤ΩÏûÖÎãàÎã§. ÏïÑÎûò ÌÖçÏä§Ìä∏Î•º ÏßÅÏ†ë Î≥µÏÇ¨ÌïòÍ±∞ÎÇò Ïä§ÌÅ¨Î¶∞ÏÉ∑ÏùÑ Ï∞çÏñ¥ Í≥µÏú†Ìï¥Ï£ºÏÑ∏Ïöî."
            );
          }
        }
      }

      document.getElementById("mbti1").addEventListener("input", function (e) {
        this.value = this.value
          .toUpperCase()
          .replace(/[^A-Z]/g, "")
          .slice(0, 4);
        if (this.value.length === 4 && !isValidMBTI(this.value)) {
          this.classList.add("is-invalid");
        } else {
          this.classList.remove("is-invalid");
        }
      });
      document.getElementById("mbti2").addEventListener("input", function (e) {
        this.value = this.value
          .toUpperCase()
          .replace(/[^A-Z]/g, "")
          .slice(0, 4);
        if (this.value.length === 4 && !isValidMBTI(this.value)) {
          this.classList.add("is-invalid");
        } else {
          this.classList.remove("is-invalid");
        }
      });

      document
        .getElementById("compatForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const mbti1 = document
            .getElementById("mbti1")
            .value.trim()
            .toUpperCase();
          const mbti2 = document
            .getElementById("mbti2")
            .value.trim()
            .toUpperCase();
          const mbti1Input = document.getElementById("mbti1");
          const mbti2Input = document.getElementById("mbti2");
          const resultDiv = document.getElementById("result");
          const shareBtn = document.getElementById("shareBtn");

          mbti1Input.classList.remove("is-invalid");
          mbti2Input.classList.remove("is-invalid");

          if (!isValidMBTI(mbti1) || !isValidMBTI(mbti2)) {
            resultDiv.innerHTML = `
              <div class="alert alert-danger d-flex align-items-center" role="alert">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2" viewBox="0 0 16 16" role="img" aria-label="Warning:">
                  <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                </svg>
                <div>
                  Ïò¨Î∞îÎ•∏ MBTI 4Í∏ÄÏûêÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. (Ïòà: INFP, ENFJ)
                </div>
              </div>`;
            resultDiv.classList.add("visible");
            shareBtn.classList.add("d-none");
            return;
          }

          const score = getCompatibilityScore(mbti1, mbti2);
          const color = getScoreColor(score);
          const fullDescription = compatibilityDescriptions.find(
            (d) => score >= d.min && score <= d.max
          ) || {
            text: "Í∂ÅÌï© ÏÑ§Î™ÖÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.",
            tip: "Ï†êÏàòÎ•º Îã§Ïãú ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.",
          };

          resultDiv.innerHTML = `
        <div class="result-content">
            <div class="result-header d-flex justify-content-center align-items-center mb-3">
                <span class="mbti-badge">${mbti1}</span>
                <span class="result-connector">‚ù§Ô∏è</span>
                <span class="mbti-badge">${mbti2}</span>
            </div>
            <div class="score-display text-center mb-3">
                <div class="compat-score-value compat-anim" style="color:${color};">${score}%</div>
                <div class="score-bar-container mt-2">
                    <div class="score-bar" style="width: ${score}%; background-color: ${color};"></div>
                </div>
            </div>
            <div class="result-text-content">
                <p class="result-description text-center mb-3">${fullDescription.text}</p>
                <hr class="my-3">
                <h5 class="result-section-title"><i class="bi bi-lightbulb-fill me-2"></i>Í¥ÄÍ≥Ñ Ï°∞Ïñ∏</h5>
                <div class="result-tip">${fullDescription.tip}</div>
            </div>
        </div>
      `;
          resultDiv.classList.add("visible");
          shareBtn.classList.remove("d-none");
          const compatElem = resultDiv.querySelector(".compat-score-value");
          if (compatElem) {
            compatElem.classList.remove("compat-anim");
            void compatElem.offsetWidth;
            compatElem.classList.add("compat-anim");
          }
          shareBtn.onclick = () =>
            shareResult(mbti1, mbti2, score, fullDescription.text);
        });
    </script>
  </body>
</html>
